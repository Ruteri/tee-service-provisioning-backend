// The KMS Server is a core component of the TEE Registry System that provides secure key management services for Trusted Execution Environment applications through two HTTP servers: a PKI server for public key infrastructure operations and an attested KMS server for operations requiring attestation verification. It connects to an Ethereum node to interact with on-chain registry contracts for identity verification and configuration management, supporting the blockchain-based governance model of the TEE Registry System. The server can be configured with different KMS implementation types (simple or Shamir's Secret Sharing), listening addresses, RPC endpoints, and logging options. Upon startup, the server initializes the selected KMS implementation, creates the two server handlers, and runs them in the background while setting up graceful shutdown on termination signals. The PKI server (default port 8081) handles certificate authority and public key operations that don't require attestation, while the attested KMS server (default port 8082) manages sensitive operations like signing CSRs and retrieving private keys. This server is typically deployed in a secure environment and accessed by the provisioning server and TEE instances during their lifecycle management, serving as a critical security component that protects cryptographic materials through attestation-based verification. Its reliable operation, secured by graceful shutdown mechanisms, is essential for maintaining the security guarantees of the entire TEE Registry System.
package main
